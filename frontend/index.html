<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<title>Semantic and Interactive Navigation In Videos</title>
</head>
<body style="width:100vw; height:100vh; ">
<div class="container" style="width: 100%; height: 100%; margin: auto; ">
    <div class="row" style="width: 100%; height: 100%;">
        <div class="col-sm" style="overflow-x: hidden; overflow-y: auto; width:50%; height:100%;"> <!-- inputs (video, crop, query) -->
            <div style="width:100%;" class="row">
                <label style="width:15%">Video: </label>
                <select id="video_names_selection" style="width:84%" name="video_names"></select>
            </div>
            <canvas class="row" style="width:100%; max-height:80%; margin:auto;" id="video"></canvas>
            <!--tabindex makes the element focusable-->
            <canvas class="row" tabindex="0" style="width:100%; height:10%; border:1px solid lightgray; margin:auto;" id="timeline"></canvas> 
            <div class="row">
                <label class="col text-left" id="crop_label">Cropped area: </label>
            </div>
            <div class="row justify-content-center">
                <canvas class="text-center" id="crop"></canvas>
            </div>
        </div>
        <div class="col-sm" style="overflow-x: hidden; overflow-y: auto; width:50%; height:100%; "> <!-- outputs (window.scores, tsne reduction, detected objects) -->
            <label class="row">Inputs:</label>
            <input type="text" id="query_input" class="row form-control"/>
            <div class="row">
                <input type="button" id="text_search_button" style="margin:0.1%;" value="Text-based search" class="btn btn-sm btn-primary"/>
                <input type="button" id="object_detection_button" style="margin:0.1%;" value="Object detection" class="btn btn-sm btn-secondary" />
                <input type="button" id="depthmap_computation_button" style="margin:0.1%;" value="Depth estimation" class="btn btn-sm btn-secondary" />
            </div>
            <div class="row">
                <input type="button" id="image_search_button" style="margin:0.1%;" value="Crop-image-based search" class="btn btn-sm btn-primary"/>
                <input type="button" id="toggle_crop" style="margin:0.1%;" value="toggle cropping" class="btn btn-sm btn-secondary" />
            </div>
            <label class="row">Outputs:</label>
            <input type="button" id="toggle_obj" style="width:100%;" value="▲ Detected objects" class="row btn btn-sm btn-info"/>
            <div class="row" id="obj_div">
                <canvas id="obj_plot" style="display:block; width:100%;"></canvas>
            </div>
            <input type="button" id="toggle_scores" style="width:100%;" value="▲ Similarity scores chart" class="row btn btn-sm btn-info"/>
            <div class="row justify-content-center" style="width:100%;" id="score_div">
                <canvas id="score_plot" style="display:block; width:100%;"></canvas>
                <div class="row">
                    <input type="button" id="select_threshold" value="select threshold" style="margin:0.1%;" class="col-sm btn btn-sm btn-secondary"/>
                    <input type="button" id="reset_score_plot" value="reset" style="margin:0.1%;" class="col-sm btn btn-sm btn-secondary"/>
                </div>
            </div>  
            <input type="button" id="toggle_reduction" style="width:100%;" value="▲ Video embeddings scatter plot in reduced embedding space" class="row btn btn-sm btn-info"/>
            <div class="row" id="reduction_div" width="100%">
                <div class="row">
                    <div class="col-sm justify-content-center">
                        <input type="radio" name="select_reduction_method" value="tsne" checked />
                        <label>t-sne</label>
                    </div>
                    <div class="col-sm justify-content-center">
                        <input type="radio" name="select_reduction_method" value="pca"/>
                        <label>pca</label>
                    </div>
                    <div class="col-sm justify-content-center">
                        <input type="radio" name="select_reduction_method" value="umap"/>
                        <label>umap</label>
                    </div>
                </div>
                <canvas class="row" id="reduction_plot" style="display:block; width:100%;" ></canvas>
                <div class="row justify-content-center">
                    <canvas class="text-center" id="reduction_color_map" height="0px"></canvas>
                </div>
                <div class="row">
                    <div class="col-sm justify-content-center">
                        <input type="radio" name="select_color_map" value="default" checked />
                        <label>default</label>
                    </div>
                    <div class="col-sm justify-content-center">
                        <input type="radio" name="select_color_map" value="clusters"/>
                        <label>dbscan</label>
                    </div>
                    <div class="col-sm justify-content-center">
                        <input type="radio" name="select_color_map" value="time"/>
                        <label>time</label>
                    </div>
                    <div class="col-sm justify-content-center">
                        <input type="radio" name="select_color_map" value="score"/>
                        <label>score</label>
                    </div>
                </div>
                <div class="row">
                    <input type="button" id="select_dots" value="navigate/select" style="margin:0.1%;" class="col-sm btn btn-sm btn-secondary"/>
                    <input type="button" id="reset_reduction_plot" value="reset" style="margin:0.1%;" class="col-sm btn btn-sm btn-secondary"/>
                </div>
            </div>
            <input type="button" id="toggle_depth" style="width:100%;" value="▲ Depth map" class="row btn btn-sm btn-info"/>
            <div class="row" id="depth_div">
                <canvas class="row" style="width:100%; " id="depth_video"></canvas>
            </div>
        </div>
    </div>
</div>
<!--global variables script-->
<script type='text/javascript' > 
    //currently used video
    window.current_video = "";

    //displayed frame
    window.current_index = 0;
    window.current_frame = new Image();
    window.max_index = 100;
    window.fps = 60;
    window.cmap = "default";

    //chart colors/sizes
    window.REGULAR_COLOR = "gray";
    window.EMPHASIS_COLOR = "red";
    window.REGULAR_RADIUS = 2.5;
    window.EMPHASIS_RADIUS = 5;

    //zoom stuff
    window.MIN_SCALE = 0.1;
    window.MAX_SCALE = 100;

    //cropping stuff
    window.crop_top_left = { x: 10, y: 10 };
    window.crop_bot_right = { x: 60, y: 60 };
    window.is_crop_visible = false;

    //selection stuff
    window.selection_top_left = { x: 10, y: 10 };
    window.selection_bot_right = { x: 40, y: 40 };
    window.is_selection = false;
    window.selected_points = [];

    //query result slot
    window.scores = null;
    window.objs = null;
    window.depth = false;

    //dimension reduction stuff
    window.old_reduction = "tsne";
    window.displayed_reduction = null;
    window.reduction_tree = null;
    window.reduction_min_x = Infinity;
    window.reduction_max_x = -Infinity;
    window.reduction_min_y = Infinity;
    window.reduction_max_y = -Infinity;

    window.tsne_reduction = null;
    window.pca_reduction = null;
    window.umap_reduction = null;

    window.tsne_clusters = null;
    window.pca_clusters = null;
    window.umap_clusters = null;
</script>

<!--includes-->
<script src="kd-tree-javascript/kdTree-min.js"></script>

<!--main script-->
<script src="main.js"></script>
<script src="video_selection.js"></script>
<script src="similarity_scores_plot.js"></script>
<script src="crop_script.js"></script>
<script src="reduction_plot.js"></script>
<script src="obj_detec_plot.js"></script>
<script src="depth_script.js"></script>
<script src="timeline.js"></script>

</body>
</html>
